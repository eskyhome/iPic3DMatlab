function [a]=spatial_smooth(b,w)
a=b;
a(2:end-1,2:end-1)=(1-w)*b(2:end-1,2:end-1)+w*(b(1:end-2,2:end-1)+b(2:end-1,1:end-2)+b(3:end,2:end-1)+b(2:end-1,3:end))/4;
end
